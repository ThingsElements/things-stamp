<link rel="import" href="../polymer/polymer.html">

<link rel="import" href="../iron-input/iron-input.html">
<link rel="import" href="../iron-icon/iron-icon.html">
<link rel="import" href="../iron-icons/iron-icons.html">
<link rel="import" href="../things-i18n-msg/things-i18n-msg.html">

<!--
`<things-stamp>` Things Stamp resource의 생성 및 수정 정보를 출력하는 컴퍼넌트
  
  Example
  
    <things-ajax
      auto
      resource-url="roles/:id"
      resource-id="7"
      last-response="{{response}}">
    </things-ajax>

    <things-stamp
      resource="[[response]]">
    </things-stamp>

@demo demo/index.html
-->
<dom-module id="things-stamp">
  <template>
      <div class="paper-font-caption"><things-i18n-msg msgid="label.create"></things-i18n-msg></div>
      <iron-icon icon="icons:alarm"></iron-icon>
      <input id="created-at" is="iron-input" value="[[createdAt]]" readonly>
      
      <iron-icon icon="icons:account-circle"></iron-icon>
      <input id="created-by" is="iron-input" value="[[creator]]" readonly>
      
      <div class="paper-font-caption"><things-i18n-msg msgid="label.update"></things-i18n-msg></div>
      <iron-icon icon="icons:alarm"></iron-icon>
      <input id="updated-at" is="iron-input" value="[[updatedAt]]" readonly>
      
      <iron-icon icon="icons:account-circle"></iron-icon>
      <input id="updated-by" is="iron-input" value="[[updater]]" readonly>
  </template>

  <script>
    Polymer({
      is: "things-stamp",

      properties: {

        /**
         * 전달 받은 resource에서 createdAt을 추출하기 위한 field 값
         */
        createdAtField: {
          type: String,
          value: 'created_at'
        },

        /**
         * 전달 받은 resource에서 updatedAt을 추출하기 위한 field 값
         */
        updatedAtField: {
          type: String,
          value: 'updated_at'
        },

        /**
         * 전달 받은 resource에서 creator를 추출하기 위한 field 값
         */
        creatorField: {
          type: String,
          value: 'creator'
        },

        /**
         * 전달 받은 resource에서 updater를 추출하기 위한 field 값
         */
        updaterField: {
          type: String,
          value: 'updater'
        },

        /**
         * resource에서 추출하는 최종 createdAt data
         */
        createdAt: {
          type: String,
          notify: true

        },

        /**
         * resource에서 추출하는 최종 createdAt data
         */
        updatedAt: {
          type: String,
          notify: true
        },

        /**
         * resource에서 추출하는 최종 creator data
         */
        creator: {
          type: String,
          notify: true
        },        

        /**
         * resource에서 추출하는 최종 updater data
         */
        updater: {
          type: String,
          notify: true
        },

        /**
         * things-ajax를 통해 전달받은 data
         */
        resource: {
          type: Object,
          observer: '_resourceChange'
        },
      },

      /**
       * resource가 변화 했을때 호출되는 function
       * 각 변수에 변화된 값을 초기화 합니다.
       */
      _resourceChange: function(resource) {
        this.createdAt = resource[this.createdAtField];
        this.updatedAt = resource[this.updatedAtField];
        this.creator = resource[this.creatorField] ? resource[this.creatorField].name : '';
        this.updater = resource[this.updaterField] ? resource[this.updaterField].name : '';
      }
    });
  </script>
</dom-module>
